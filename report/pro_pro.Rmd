---
title: "Multi-label Classification of news articles on Coronavirus"
output:
  rmarkdown::html_document:
    number_sections: true
    theme: lumen

---
<style type="text/css">
.main-container {
  max-width: 1000px;
  margin-left: auto;
  margin-right: auto;
}
</style>

```{r setup, include = FALSE, echo = FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(here)

```



<style>
body {
text-align: justify}
</style>

# **Overview & Motivation**

Ever since COVID-19 erupted into our world, research institutes and governments have released plenty of databases publicly to allow research groups and independent individuals to analyze the data around the coronavirusâs spread. We are facing an unprecedented public health crisis with the Coronavirus (Covid-19) outbreak. We believe that data-driven decisions, and people working together for the greater good, are one of the better ways to tackle and deal with this difficult time.

In this blog, we are interested to know âHow the worldâs news media is covering the COVID-19 pandemic?â Building on the massive television news narratives dataset GDELT released a powerful news dataset of the URLs, titles, publication dates and brief snippet of more than 1.1 million worldwide English language online news articles mentioning the virus to enable researchers and journalists to understand the global context of how the outbreak has been covered since November 2019. This dataset has been expanding daily and includes a number of related topics.

A single article on Covid-19 can cover various topics like health, business implications of the disease or climate changes or it could just be a front to propagate fake information. Given the huge amount of news articles floating around the web in the wake of Covid-19, it is very difficult to compile and compare the news articles. To conduct an analysis of what is being discussed during these difficult times, we would have to first collect all the news articles and then annotate them according to their implicit news sub-categories. This motivates us to create an approach such that we could annotate news articles on Coronavirus without any manual intervention. By creating such a pipeline we not only aim to help researchers, media persons and Journalists to have access to similar articles but also avoid the overhead of time spent in reading and understanding unrelated articles. Thus we aim to improve the quality of similar articles and thus topics representing them.

We intend to solve the huge flow of information called âinformation overloadâ which makes it harder for users to find similar information on Covid-19 on the internet. We solve this with an application that enables the user to find news of their query/interest effortlessly. We are foreseeing some challenges, that include determining the subtopic, extract only the content of each webpage and present the data to the user. In real-world applications, multi-label classification (MLC) has a lot of utility in which objects can be identified by more than one label. Itâs costly and tedious to manually label the dataset. An unsupervised learning approach should, therefore, be considered to take advantage of clustering similar datasets and eventually doing topic modelling to multi-label the clusters. We use unsupervised learning technique(Clustering) to group a collection of articles so that articles in the same category are more similar to each other than those in other groups. Clustering can be used to help classify the types of a structure discovered.

We are trying to analyze the large set of news articles to help make it easier for common people to filter through many articles related to the virus, and find their own resoluteness.Furthermore, we would want to understand the semantic relations between different topics. And finally, analyze keywords to uncover patterns in the news content.

# **Related Work**

The goal of our project is to retrieve most relevant news articles, given an article on coronavirus.While several other works exist on finding document similarity, we were mainly concerned with finding those that are focused on topical similarity rather than the sematically similarity. Previous researches indicate that Latent Dirichlet Allocation (LDA) techinque of topic modeling has proven to be successful in learning hidden topics from a corpus.Thus we decided to make use of LDA to extract topics for the news articles in our dataset.

Topic modeling is one of the most powerful techniques in text mining for latent data discovery Researchers have published many articles in the field of topic modeling and applied it in various fields [Jelodar, Wang, et al.]. In topic models, it is assumed that a document is generated by a mixture of topics, each of which is a distribution over words in the vocabulary. By fitting the models, we can represent each document through the learned topics as well as understand the topics in the corpus through the most probable words of each topic.
The Latent Dirichlet allocation (LDA) is a topic modeling technique, proposed by [Blei et al., 2003].Further different variants of topic model such as author-topic-model(ATM)[Rosen-Zvi et al., 2004], Labeled-LDA [Ramage et al., 2009], etc. evolved.From results on prior research it is evident that LDA based topics still serve as a state of the art topic modeling technique.In 2011, [Grun et al., (2011)] published a paper on topic models with its implementation in R. This package is known as topicmodels in CRAN. 

Add more content

# **Research Questions**<br>
Can we find articles with similar topics to a given an article ?<br>
In order to answer this question, we need to answer the following reasearch questions: <br>
1. What is the most dominant topic in the article?<br>
2. How to determine the value of K is best suited  and interpretable for topic modeling on our dataset ?<br>
3. How does the topic model perform with different features, namely Term frequencyâInverse document &nbsp;&nbsp;&nbsp;&nbsp;frequency (Tf - Idf) along with Bag of Words and Bag of words (TF) by itself.
 

# **Dataset**
* **Data source**<br>
For our dataset we required news articles that spoke about the ongoing coronavirus pandemic. In our search, we came across the Gdelt Project, that contained a compilation of URLs and brief snippets of worldwide English language news coverage mentioning Covid-19. It contains data from the the period November 1, 2019 through March 26, 2020. 
Gdelt dataset: http://data.gdeltproject.org/blog/2020-coronavirus-narrative/live_onlinenews/MASTERFILELIST.TXT

* **Scraping Method**<br>
On digging deeper into the dataset we realized that only snippets of the news articles were included.The snippets were chosen by performing a keyword search for the given terms: Cases, Covid19, Falsehoods, Masks, Panic, Prices, Quarantine, Shortages, SocialDistancing, Testing and Ventilators; and selecting the paragraph with its first occurrence. In addition to the presence of one of the given terms, either the sentence itself or the oneâs before and after them should also contain the term âCoronavirusâ or âCovid-19â, thus ensuring that the news article is realted to coronavirus.<br>&nbsp;&nbsp;&nbsp;&nbsp;
The Gdelt dataset had news articles related to coronavirus, but just a snippet wouldnât be suffiecient to understand the underlying topic of an article. Hence, we decided to scrape the articles by ourselves by using urls corresponding to each article of the Gdelt dataset.<br>&nbsp;&nbsp;&nbsp;&nbsp;
The dataset contained several files, each containing articles extracted on a particular day, having a particular keyword. As considering all the articles in each file would be computationally too heavy & infeasible, we agreed on creating a dataset having around 20000 records. We realize the topics discussed during the initial period of the pandemic and in the months to follow must have evolved. In order to capture the wide array of topics over the duration of 5 months, we first downloaded all files. Then for all the files belonging to a keyword we extract certain records. This was repeated for all keywords. Thus at the end of the extraction process we had around 20000 news articles as our final dataset.

* **Cleanup**<br>
As the content we extracted were from websites, it contained numerous html tags and special characters. In the preprocessing stage,we first converted the data to lower case. We then cleaned the data by removing the urls(www, http), punctuations, special charachters, stopwords and also stripped the whitespaces in it. Once the preprocessing was complete the preprocessed corpus was ready for analysis.

* **Storage**<br>
The dataset after preprocessing was stored in a csv file and uploaded on the drive. Dataset: https://drive.google.com/file/d/1qgQiIIi1yhXBj1jAOVz_2dhNT4C2i6bc/view?usp=sharing

# **Exploratory Analysis**
## **Overview of the Dataset with plots ** :
### **Distribution of Articles  ** :

The news articles were distributed over the below categories.These categories are nothing but the keywords that were used to collect the articles by the GDELT project. Although we do not intend to use these labels assigned to each article, but in order to avoid any biased results, we've taken a fair distribution of articles from every set.
```{r,out.width='70%', fig.align='center', fig.cap='...',echo = FALSE}
knitr::include_graphics(here("plots","donut.png"))
```
### **Pre-processing ** :
Our Dataset is in text format and therefore we pre-processed it before performing any kind of exploratory analysis. This was required in order to clean it and remove unnecessary words or characters that would affect our analysis in any way.Pre-processing is one of the very important steps of Natural Language processing, because a well pre-processed data speeds up the computation time required for further analysis and also the quality of tokens and results tend to be higher compared to the poorly pre-processed data.

Steps taken for Pre-processing<br>


* **Removed URL's from the content**

* **Replaced punctuations, numbers and any other characters apart from alphabets**

* **Coverted Latin words to Utf-8**

* **Conerted the text to lower case**

* **Removed Stop words**


### **Wordcloud ** :
Wordclouds are a representative of underlying words in any text or the news articles dataset in our case.We've generated wordclouds for 2 different models of Bag of Words, that are with Term Frequency and TF-IDF. We wanted to analyse and understand how does the size and type of words differ when the weighting scheme changes for the same corpus. 

#### **TF ** :

As we can see in the below wordcloud, news articles have been all about the coronavirus pandemic.The Terms with higher frequencies are the ones bigger in size. Since the method used for below wordcloud is TF the most

```{r eval=FALSE}
wordcloud2(d_bow,shape = "star",size = 0.4)
```

```{r,out.width='500%', echo=FALSE,fig.align='center', fig.cap='...',echo = FALSE}
knitr::include_graphics(here("plots","starcloud_bow.jpeg"))
```

#### **TF-IDF ** :

Using Bag of Words Model with TF-IDF Weighting scheme.
```{r eval=FALSE}
wordcloud2(d_tfidf,shape = "star",size = 0.15)
```
```{r,out.width='500%', echo=FALSE,fig.align='center', fig.cap='...',echo = FALSE}
knitr::include_graphics(here("plots","star_tfidf.jpeg"))
```


# **Final Analysis**

## **Optimal Topics Search ** :
We've used elbow method along with other metrics to determine optimal topics for Topic Modelling.

### **Topic Modelling** :
Topic modelling was done considering different values of Topics. Our intention in this process was to tune the hyperparameter which is no of topics and thus, choose no of topics for the best performing model between BOW with TF vs BOW with TF-IDF. Perplexity score is the measure of interpretability of topics. 

#### **Perplexity** :

```{r,out.width='70%', fig.align='center', fig.cap='Perplexity Score',echo = FALSE}
knitr::include_graphics(here("plots","perplexity.jpeg"))
```

### **LDA Tuning** :


## **Topic Modelling using LDA for Prediction** :

### **Bag of Words with Term Frequency as Weighting Scheme** :

#### **Parallel Co-ordinates plot for Gibbs Sampling as Model 1** :

```{r, eval=FALSE}
#Plot
ggparcoord(bow_test_train_model1,
           columns = 1:25, groupColumn = 26,
           scale = 'uniminmax',
           showPoints = TRUE,
           title = "Parallel Coordinate Plot For Model 1 with BOW as FE",
           alphaLines = 0.1
) + scale_color_viridis(discrete=TRUE) +
  theme_ipsum()+
  theme(plot.title = element_text(size=8))

```

```{r,out.width='800%', fig.align='center', fig.cap='Plot 1 for Gibbs Sampling as Model 1',echo = FALSE}
knitr::include_graphics(here("plots","BOW_PC_25topics_model1-gibbs.jpeg"))
```

#### **PC plot for Dot Product as Model 2** :

```{r, eval=FALSE}
#Plot
ggparcoord(bow_test_train_model2,
           columns = 1:25, groupColumn = 26,
           scale = 'uniminmax',
           showPoints = TRUE,
           title = "Parallel Coordinate Plot For Model 2 with BOW as FE",
           alphaLines = 0.1
) + scale_color_viridis(discrete=TRUE) +
  theme_ipsum()+
  theme(plot.title = element_text(size=8))
```


```{r,out.width='800%', fig.align='center', fig.cap='Plot 2 for Dot Product as Model 2',echo = FALSE}
knitr::include_graphics(here("plots","bow_pc_25topics_model2-dot.jpeg"))
```



### **Model Evaluation** :
Below metric was used for evaluating model.




#### **Likelihood** :

```{r, eval=FALSE}
#Plot

```

```{r,out.width='60%', fig.align='center', fig.cap='Likelihood Score',echo = FALSE}
knitr::include_graphics(here("plots","liklihood.jpeg"))
```


## **Visualizations** :

The first step was to reduce teh dimensionality Using Tsne from a feature set of 1000's of columns representing words for the BOW with TF weighting scheme.

### **Optimal cluster Number search** :
```{r, eval=FALSE}
#Reducing the dimensions via tsne
tsne <- Rtsne(doc_topics_gamma[,-1], perplexity = 30, pca = FALSE, check_duplicates = FALSE)
X <- data.frame(tsne$Y)

#Find best no. of clusters for 25 topics
wss <- (nrow(X)-1)*sum(apply(X,2,var))
for (i in 1:100) wss[i] <- sum(kmeans(X,iter.max = 50L,centers=i)$withinss)
plot(1:100, wss, type="b", xlab="Number of Clusters", ylab="Within groups sum of squares")
```

```{r,out.width='80%', fig.align='center', fig.cap='Elbow Curve Plot',echo = FALSE}
knitr::include_graphics(here("plots","cluster_on_topics.jpeg"))
```
### **Clustering** :

####clustering via k means


##### **Convex Hull Plot ** :

```{r,out.width='60%', fig.align='center', fig.cap='...',eval = FALSE}

k3 <- kmeans(X,centers = 8, nstart = 5,iter.max = 100000L)

fviz_cluster(k3,X)
```

```{r,out.width='90%', fig.align='center', fig.cap='Convex Hull Plot for 8 clusters',echo = FALSE}
knitr::include_graphics(here("plots","convexhull2.jpeg"))
```

##### **Evaluation Using Silhouette Coefficient for 8 clusters** :

```{r,out.width='80%', fig.align='center', fig.cap='Silhouette Coefficient Plot 1',echo = FALSE}
knitr::include_graphics(here("plots","clusters_8.jpeg"))
```


##### **Evaluation Using Silhouette Coefficient for 15 clusters** :
```{r,out.width='80%', fig.align='center', fig.cap='Silhouette Coefficient Plot 2',echo = FALSE}
knitr::include_graphics(here("plots","clusters15.jpeg"))
```

##### **Topic to Word Occurence** :

Sankey Network Diagram
```{r,eval=FALSE}
links <- data.frame(
  source = top_terms$topic,
  target = top_terms$term,
  value = top_terms$beta
)

nodes <- data.frame(
  name=c(as.character(links$source), 
         as.character(links$target)) %>% unique()
)

# With networkD3, connection must be provided using id, not using real name like in the links dataframe.. So we need to reformat it.
links$IDsource <- match(links$source, nodes$name)-1 
links$IDtarget <- match(links$target, nodes$name)-1
# Make the Network
p <- sankeyNetwork(Links = links, Nodes = nodes,
                   Source = "IDsource", Target = "IDtarget",
                   Value = "value", NodeID = "name", 
                   colourScale = JS("d3.scaleOrdinal(d3.schemeCategory20);"),
                   sinksRight=FALSE,fontSize = 16,height = 1400,width = 1200,
                   nodePadding = 8, fontFamily = "arial",unit = "Letter(s)")
p

```

```{r showChoro1, echo=FALSE,fig.align='center', fig.cap='Sankey Diagram',echo = FALSE}

htmltools::includeHTML(here("plots","sankeyBasic1.html"))

```

##### **Topics associated to each Cluster** :

Chord Diagram

```{r,eval=FALSE}
chordDiagram(new_v,big.gap = 10,directional = 1, direction.type = c("diffHeight", "arrows"),link.arr.type = "big.arrow", diffHeight = -mm_h(1),grid.col = c("violet", "blue4", "blue","green", "yellow","tomato","red","cyan4","deeppink","cyan3","chocolate4","darkslategrey","darksalmon","chartreuse","darkorchid2","deepskyblue1","lightcoral", "palegreen4", "paleturquoise2","palevioletred", "peru", "pink4", "purple2","sienna1","skyblue2","seagreen2","rosybrown","plum3","slateblue2","orange3","darkgoldenrod2","salmon2","pink2")

```
```{r,out.width='110%', fig.align='center', fig.cap='Chord Diagram for Topic to Cluster association',echo = FALSE}
knitr::include_graphics(here("plots","chord_diag_final.jpeg"))
```


##### **Probability Distribution of Topics in each Cluster** :

```{r,eval = FALSE}

bp <- ggplot(temp, aes(x= Topic_Number,
      y=Topic_Probability, group = 1)) + 
      geom_line(color = "steelblue",size = 2) + 
      geom_point(size = 2) +
      labs(title = "Topic Distribution in each Cluster",
      y = "Average Probability", x = "Topic Number")

bp +facet_grid(Cluster_Number ~ .)
```
```{r,out.width='600%', fig.align='center', fig.cap='Probability Distribution of Topics in each cluster',echo = FALSE}
knitr::include_graphics(here("plots","topic_dist.jpeg"))
```

##### **LDA Vis** :

```{r,out.width='600%', fig.align='center', fig.cap='Terms in Topics',echo = FALSE}
knitr::include_graphics(here("plots","lda_vis.jpg"))
```

#####**R bokeh plot** :

```{r,eval = FALSE}

figure(title = "Rbokeh plot representing Documents and topics", width = 1200, height = 600) %>%
  
  ly_points(x = X1, y = X2,data = bow_test_train_model1,color = type,
            hover=c(topic_highest_prob,title,url,keywords),size = 3
  ) %>%
  
  set_palette(discrete_color = pal_color(c( "red", "skyblue")))

```

```{r showChoro2, echo=FALSE,fig.align='center', fig.cap='Rbokeh plot for Documents grouped by Test and Train Records',echo = FALSE}

htmltools::includeHTML(here("plots","rbokeh_testntrain.html"))

```

```{r,eval = FALSE}

figure(title = "Rbokeh plot representing Documents and topics", width = 1200, height = 600) %>%
  
  ly_points(x = X1, y = X2,data = bow_test_train_model1,color = topic_highest_prob,
            hover=c(topic_highest_prob,title,url),size = 5) 

```




```{r showChoro3, echo=FALSE,fig.align='center', fig.cap='Rbokeh plot for Documents grouped by Topics '}

htmltools::includeHTML(here("plots","rbokeh_topics.html"))

```


##### **Documents Similarity** :




# **Conclusion**
What did you learn about the data?
How did you answer the questions?
How can you justify your answers?


# **Future Work**


# **References**

# **Team members**
| Name                       | Email-Id                                                     | Mattr No. |
| -------------------------- | ------------------------------------------------------------ | --------- |
| Calida Pereira             | [calida.pereira@st.ovgu.de](mailto:calida.pereira@st.ovgu.de) | 229945    |
| Chandan Radhakrishna       | [chandan.radhakrishna@st.ovgu.de](mailto:chandan.radhakrishna@st.ovgu.de) | 229746    |
| Nandish Bandi Subbarayappa | [nandish.bandi@st.ovgu.de](mailto:nandish.bandi@st.ovgu.de)  | 229591    |
| Mohit Jaripatke            | [mohit.jaripatke@st.ovgu.de](mailto:mohit.jaripatke@st.ovgu.de) | 224651    |
| Priyanka Bhargava          | [priyanka.bhargava@st.ovgu.de](mailto:priyanka.bhargava@st.ovgu.de) | 229675    |

